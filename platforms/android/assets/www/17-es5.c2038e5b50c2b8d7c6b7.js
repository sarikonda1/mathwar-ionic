function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{G8VQ:function(e,t,n){"use strict";n.r(t),n.d(t,"BattleModule",(function(){return B}));var i=n("ofXK"),s=n("TEn/"),o=n("3Pt+"),r=n("oo/y"),a=n("tIkO"),c=n("tk/3"),l=n("tyNb"),u=n("mrSG"),b=n("fXoL"),d=n("z5bb"),g=n("IArL"),p=n("TFC3"),f=n("s9Uj");function h(e,t){1&e&&b.Lb(0,"img",18)}function m(e,t){if(1&e&&b.Lb(0,"img",19),2&e){var n=b.Zb(3);b.ec("src",n.imgUrl,b.pc)}}function v(e,t){if(1&e&&(b.Pb(0,"div",12),b.Pb(1,"ion-avatar",13),b.sc(2,h,1,0,"img",14),b.sc(3,m,1,1,"img",15),b.Ob(),b.Pb(4,"span",16),b.uc(5,"Vs"),b.Ob(),b.Pb(6,"ion-avatar",17),b.Lb(7,"img",18),b.Ob(),b.Ob()),2&e){var n=b.Zb(2);b.zb(2),b.ec("ngIf",""===n.imgUrl),b.zb(1),b.ec("ngIf",""!==n.imgUrl)}}function P(e,t){if(1&e&&(b.Pb(0,"div",20),b.Pb(1,"ion-text"),b.uc(2),b.Ob(),b.Ob()),2&e){var n=b.Zb(2);b.zb(2),b.vc(null==n.gameStatus?null:n.gameStatus.message)}}function O(e,t){if(1&e&&(b.Pb(0,"div",8),b.sc(1,v,8,2,"div",9),b.Pb(2,"div"),b.Lb(3,"ion-spinner",10),b.Ob(),b.sc(4,P,3,1,"div",11),b.Ob()),2&e){var n=b.Zb();b.zb(1),b.ec("ngIf",n.gameStatus),b.zb(3),b.ec("ngIf",n.gameStatus)}}function w(e,t){if(1&e&&(b.Pb(0,"ion-grid"),b.Pb(1,"ion-row"),b.Pb(2,"ion-col",21),b.Pb(3,"ion-chip",22),b.Lb(4,"img",23),b.Pb(5,"ion-label"),b.uc(6),b.Ob(),b.Ob(),b.Ob(),b.Ob(),b.Ob()),2&e){var n=b.Zb();b.zb(3),b.ec("ngClass",(null==n.mainService?null:n.mainService.timeLeft)>100?"more":"danger"),b.zb(3),b.wc("",null==n.mainService?null:n.mainService.timeLeft," Sec")}}function x(e,t){if(1&e&&(b.Pb(0,"ion-col",25),b.Pb(1,"div",26),b.Pb(2,"ion-text"),b.uc(3),b.Ob(),b.Ob(),b.Pb(4,"div",27),b.Lb(5,"ion-progress-bar",28),b.Pb(6,"span",29),b.uc(7),b.Ob(),b.Ob(),b.Ob()),2&e){var n=t.$implicit,i=t.even,s=b.Zb(2);b.zb(3),b.wc(" ",s.userId==n.userId?"You":n.userdetails[0].username,""),b.zb(2),b.fc("value",n.score/(null==s.battleResponse||null==s.battleResponse.questions?null:s.battleResponse.questions.length)),b.ec("color",i?"secondary":"primary"),b.zb(2),b.wc(" ",n.score,"")}}function y(e,t){if(1&e&&(b.Pb(0,"ion-gird"),b.Pb(1,"ion-row"),b.sc(2,x,8,4,"ion-col",24),b.Ob(),b.Ob()),2&e){var n=b.Zb();b.zb(2),b.ec("ngForOf",n.battlePlayers)}}function C(e,t){if(1&e){var n=b.Qb();b.Pb(0,"div"),b.Pb(1,"app-number-cruncher-question",33),b.Xb("questionLoaded",(function(e){return b.nc(n),b.Zb(4).onQuestionLoaded(e)}))("sendAnswer",(function(e){return b.nc(n),b.Zb(4).enteredNumber(e)})),b.Ob(),b.Ob()}if(2&e){var i=b.Zb(2),s=i.$implicit,o=i.index,r=b.Zb(2);b.rc("height",r.deviceHeight,"px"),b.zb(1),b.ec("inputQuestion",r.splittingQuestion(s,o))("showOperators",r.isShowOperator)("inputClass",r.buttonValue)("enteredAnswer",r.enteredAnswer)}}function k(e,t){if(1&e){var n=b.Qb();b.Pb(0,"div"),b.Pb(1,"app-question",34),b.Xb("sendAnswer",(function(e){return b.nc(n),b.Zb(4).enteredNumber(e)})),b.Ob(),b.Ob()}if(2&e){var i=b.Zb(2),s=i.$implicit,o=i.index,r=b.Zb(2);b.rc("height",r.deviceHeight,"px"),b.zb(1),b.ec("inputQuestion",r.splittingQuestion(s,o))("showOperators",r.isShowOperator)("inputClass",r.buttonValue)("enteredAnswer",r.enteredAnswer)("operatorClass",r.operatorClassRequired)}}function S(e,t){if(1&e&&(b.Nb(0),b.sc(1,C,2,6,"div",31),b.sc(2,k,2,7,"ng-template",null,32,b.tc),b.Mb()),2&e){var n=b.mc(3),i=b.Zb().$implicit;b.zb(1),b.ec("ngIf",5===(null==i?null:i.answerType))("ngIfElse",n)}}function z(e,t){if(1&e&&(b.Nb(0),b.sc(1,S,4,2,"ng-container",6),b.Mb()),2&e){var n=t.index,i=b.Zb(2);b.zb(1),b.ec("ngIf",n===i.currentQuestion)}}function _(e,t){if(1&e&&(b.Nb(0),b.sc(1,z,2,1,"ng-container",30),b.Mb()),2&e){var n=b.Zb();b.zb(1),b.ec("ngForOf",n.battleResponse.questions)}}function I(e,t){1&e&&b.Lb(0,"img",46)}function M(e,t){if(1&e&&b.Lb(0,"img",19),2&e){var n=b.Zb().$implicit,i=b.Zb(2);b.ec("src",i.imageUrl(n),b.pc)}}var L=function(e){return{"current-user":e}};function Q(e,t){if(1&e&&(b.Pb(0,"ion-card"),b.Pb(1,"ion-row",40),b.Pb(2,"ion-col",41),b.uc(3),b.Ob(),b.Pb(4,"ion-col",42),b.Pb(5,"ion-avatar",13),b.sc(6,I,1,0,"img",43),b.sc(7,M,1,1,"img",15),b.Ob(),b.Ob(),b.Pb(8,"ion-col",44),b.uc(9),b.Ob(),b.Pb(10,"ion-col",45),b.uc(11),b.Ob(),b.Ob(),b.Ob()),2&e){var n=t.$implicit,i=t.index,s=b.Zb(2);b.zb(1),b.ec("ngClass",b.hc(6,L,s.userId==n.userId)),b.zb(2),b.vc(i+1),b.zb(3),b.ec("ngIf",""==(null==n||null==n.userdetails[0]?null:n.userdetails[0].avatar)||null==(null==n||null==n.userdetails[0]?null:n.userdetails[0].avatar)),b.zb(1),b.ec("ngIf",""!==(null==n||null==n.userdetails[0]?null:n.userdetails[0].avatar)||void 0!==(null==n||null==n.userdetails[0]?null:n.userdetails[0].avatar)),b.zb(2),b.wc(" ",n.userdetails[0].username,""),b.zb(2),b.wc(" ",n.score,"")}}function R(e,t){if(1&e&&(b.Nb(0),b.Pb(1,"ion-row",35),b.Pb(2,"ion-col",36),b.uc(3," Rank "),b.Ob(),b.Pb(4,"ion-col",37),b.uc(5," Name "),b.Ob(),b.Pb(6,"ion-col",38),b.uc(7," Score "),b.Ob(),b.Ob(),b.Pb(8,"ion-grid",39),b.sc(9,Q,12,8,"ion-card",30),b.Ob(),b.Mb()),2&e){var n=b.Zb();b.zb(9),b.ec("ngForOf",n.battlePlayers)}}function A(e,t){if(1&e){var n=b.Qb();b.Pb(0,"ion-footer",47),b.Pb(1,"ion-grid"),b.Pb(2,"ion-row",48),b.Pb(3,"ion-col",49),b.Pb(4,"ion-fab-button",50),b.Xb("click",(function(){return b.nc(n),b.Zb().resetData()})),b.Pb(5,"ion-avatar",51),b.Lb(6,"img",52),b.Ob(),b.Ob(),b.Ob(),b.Pb(7,"ion-col",49),b.Pb(8,"ion-fab-button",53),b.Xb("click",(function(){return b.nc(n),b.Zb().skip()})),b.Pb(9,"ion-avatar",54),b.Lb(10,"img",55),b.Ob(),b.Ob(),b.Ob(),b.Pb(11,"ion-col",49),b.Pb(12,"ion-fab-button",56),b.Xb("click",(function(){return b.nc(n),b.Zb().submitQuestion()})),b.Pb(13,"ion-avatar",57),b.Lb(14,"img",58),b.Ob(),b.Ob(),b.Ob(),b.Ob(),b.Ob(),b.Ob()}if(2&e){var i=b.Zb();b.zb(8),b.ec("disabled",!i.isQuestionLoaded),b.zb(4),b.ec("disabled",!i.isQuestionLoaded)}}var Z,q,F,G=[{path:"",component:(Z=function(){function e(t,n,i,s,o,r){var a,c,l,u,b=this;_classCallCheck(this,e),this.socketService=t,this.formBuilder=n,this.router=i,this.mainService=s,this.cd=o,this.platform=r,this.endGame=!1,this.gameStarted=!1,this.currentQuestion=0,this.enteredAnswer="",this.operatorClassRequired=!0,this.isQuestionLoaded=!0,this.imgUrl="",this.subscribe=this.mainService.getLeaveRoomStatus().subscribe((function(e){e&&b.gameStatus&&b.socketService.leaveGame(b.userId,b.gameStatus.gameId)})),this.questionForm=this.formBuilder.group({answer:""}),this.imgUrl=void 0!==(null===(c=null===(a=this.mainService.userData)||void 0===a?void 0:a.userDetails)||void 0===c?void 0:c.avatar)?this.socketService.BASE_URL+"/"+(null===(u=null===(l=this.mainService.userData)||void 0===l?void 0:l.userDetails)||void 0===u?void 0:u.avatar):""}return _createClass(e,[{key:"ngOnInit",value:function(){this.deviceHeight=this.platform.height()-350;var e=JSON.parse(localStorage.getItem("currentUser"));e&&(this.userId=e.userId,this.userName=e.userName,this.establishSocketConnection(),this.getPlayerList())}},{key:"onQuestionLoaded",value:function(e){this.isQuestionLoaded=!0}},{key:"establishSocketConnection",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.socketService.connectSocket(this.userId);case 3:this.battle(),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),alert("Something went wrong");case 9:case"end":return e.stop()}}),e,this,[[0,6]])})))}},{key:"getPlayerList",value:function(){var e=this;this.socketService.getPlayerList(this.userId).subscribe((function(t){e.playerList=t.playerList}))}},{key:"battle",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.endGame=!1,this.gameStarted=!1,e.next=4,this.socketService.startBattle(this.userId);case 4:this.listenForStatus(),this.listenForBattle(),this.listenForScore(),this.listenForEndGame();case 8:case"end":return e.stop()}}),e,this)})))}},{key:"listenForBattle",value:function(){var e=this;this.socketService.receiveQuestions().subscribe((function(t){e.battleResponse=t,localStorage.setItem("gameId",JSON.stringify(e.battleResponse.gameId)),e.battlePlayers=t.players,e.gameStarted=!0,e.setQuestionStatus(),e.mainService.startTimer(e.battlePlayers.interval)}))}},{key:"listenForStatus",value:function(){var e=this;this.socketService.getBattleStatus().subscribe((function(t){e.gameStatus=t,localStorage.setItem("gameStatus",JSON.stringify(e.gameStatus))}))}},{key:"listenForScore",value:function(){var e=this;this.socketService.getBattleScore().subscribe((function(t){e.gameScore=t,e.battlePlayers=t.players}))}},{key:"imageUrl",value:function(e){var t,n;return void 0!==(null===(t=null==e?void 0:e.userdetails[0])||void 0===t?void 0:t.avatar)&&this.socketService.BASE_URL+"/"+(null===(n=null==e?void 0:e.userdetails[0])||void 0===n?void 0:n.avatar)}},{key:"listenForEndGame",value:function(){var e=this,t=this;this.socketService.endGame().subscribe((function(n){t.battlePlayers=e.battlePlayers.sort((function(e,t){return e.score<t.score?1:t.score<e.score?-1:0})),t.battleResponse=null,localStorage.removeItem("canClosePage"),t.mainService.clearTimer(),t.endGame=!0,t.cd.detectChanges(),setTimeout((function(){t.gameStatus=void 0,t.battlePlayers=[],t.router.navigate(["home"])}),3e7)}))}},{key:"setQuestionStatus",value:function(){5===this.battleResponse.questions[this.currentQuestion].answerType&&(this.isQuestionLoaded=!1)}},{key:"submitQuestion",value:function(){this.currentQuestion++,this.setQuestionStatus(),"\xd7"===this.enteredAnswer&&(this.enteredAnswer="*"),"\xf7"===this.enteredAnswer&&(this.enteredAnswer="/"),this.socketService.updateAnswer(this.battleResponse.gameId,this.battleResponse.lobbyId,this.userId,this.battleResponse.questions[this.index].question,this.index,this.enteredAnswer,this.battleResponse.questions[this.index].answerType),this.enteredAnswer=""}},{key:"skip",value:function(){this.submitQuestion()}},{key:"splittingQuestion",value:function(e,t){switch(this.index=t,this.questionSplit=e.question.split(" "),e.answerType){case 2:this.isShowOperator=!0;break;default:this.isShowOperator=!1}return this.operatorClassRequired=3!==e.answerType&&4!==e.answerType,this.questionSplit}},{key:"enteredNumber",value:function(e){this.enteredAnswer=e}},{key:"resetData",value:function(){this.enteredAnswer=""}},{key:"getAvatarUrl",value:function(e){return this.socketService.BASE_URL+"/"+e}}]),e}(),Z.\u0275fac=function(e){return new(e||Z)(b.Kb(d.a),b.Kb(o.a),b.Kb(l.g),b.Kb(g.a),b.Kb(b.h),b.Kb(s.O))},Z.\u0275cmp=b.Eb({type:Z,selectors:[["app-battle"]],decls:13,vars:10,consts:[[3,"translucent"],[3,"ngClass"],["slot","start"],[1,"ion-text-center","ion-text-uppercase","math-title","title-space"],[3,"fullscreen"],["class","ion-padding-bottom waiting-player",4,"ngIf"],[4,"ngIf"],["class","box-shadow",4,"ngIf"],[1,"ion-padding-bottom","waiting-player"],["class","ion-text-center waiting-icon",4,"ngIf"],["name","dots"],["class","waiting-text",4,"ngIf"],[1,"ion-text-center","waiting-icon"],[1,"profile-img","box-shadow"],["src","../../assets/icon/profile.png","class","box-shadow",4,"ngIf"],["class","pro-dp box-shadow",3,"src",4,"ngIf"],[1,"ion-padding-horizontal","vs"],[1,"default-img","box-shadow"],["src","../../assets/icon/profile.png",1,"box-shadow"],[1,"pro-dp","box-shadow",3,"src"],[1,"waiting-text"],[1,"ion-text-center"],["outline","",1,"timer",3,"ngClass"],["src","assets/img/timer.png"],["size","6",4,"ngFor","ngForOf"],["size","6"],[1,"person-name"],[1,"ion-display-progress"],[3,"value","color"],[1,"ion-curve"],[4,"ngFor","ngForOf"],[3,"height",4,"ngIf","ngIfElse"],["all_quens",""],[3,"inputQuestion","showOperators","inputClass","enteredAnswer","questionLoaded","sendAnswer"],[3,"inputQuestion","showOperators","inputClass","enteredAnswer","operatorClass","sendAnswer"],[1,"score-titles"],["size","4"],["size","4",1,"ion-text-center"],["size","4",1,"ion-text-right"],[1,"ion-no-padding"],[1,"score-card",3,"ngClass"],["size","2",1,"score-rank","ion-text-center"],["size","2",1,"pro-dp"],["src","assets/icon/profile.png","class","default-image",4,"ngIf"],["size","6",1,"score-name"],["size","2",1,"score-pts"],["src","assets/icon/profile.png",1,"default-image"],[1,"box-shadow"],[1,"ion-justify-content-center"],["size","3"],["size","small","color","danger",1,"footer-btn","box-shadow",3,"click"],[1,"footer-grid","close"],["src","../../assets/icon/close.png"],["size","small","color","warning",1,"footer-btn","box-shadow",3,"disabled","click"],[1,"footer-grid","eraser"],["src","../../assets/icon/eraser.png"],["size","small","color","success",1,"footer-btn","box-shadow",3,"disabled","click"],[1,"footer-grid","right"],["src","../../assets/icon/right.png"]],template:function(e,t){1&e&&(b.Pb(0,"ion-header",0),b.Pb(1,"ion-toolbar",1),b.Pb(2,"ion-buttons",2),b.Lb(3,"ion-back-button"),b.Ob(),b.Pb(4,"ion-title",3),b.uc(5),b.Ob(),b.Ob(),b.Ob(),b.Pb(6,"ion-content",4),b.sc(7,O,5,2,"div",5),b.sc(8,w,7,2,"ion-grid",6),b.sc(9,y,3,1,"ion-gird",6),b.sc(10,_,2,1,"ng-container",6),b.sc(11,R,10,1,"ng-container",6),b.Ob(),b.sc(12,A,15,2,"ion-footer",7)),2&e&&(b.ec("translucent",!0),b.zb(1),b.ec("ngClass",t.endGame&&t.battlePlayers.length?"primary-toolbar":"secondary-toolbar"),b.zb(4),b.wc(" ",t.endGame&&t.battlePlayers.length?"Score":"Battle"," "),b.zb(1),b.ec("fullscreen",!0),b.zb(1),b.ec("ngIf",!t.gameStarted),b.zb(1),b.ec("ngIf",!t.endGame&&t.battleResponse&&t.battlePlayers),b.zb(1),b.ec("ngIf",!t.endGame&&t.battleResponse&&t.battlePlayers),b.zb(1),b.ec("ngIf",!t.endGame&&t.battleResponse),b.zb(1),b.ec("ngIf",t.endGame&&t.battlePlayers.length),b.zb(1),b.ec("ngIf",!t.endGame&&t.battleResponse&&t.battlePlayers))},directives:[s.u,s.H,i.i,s.i,s.f,s.g,s.F,s.q,i.k,s.D,s.e,s.E,s.t,s.C,s.p,s.o,s.y,i.j,s.A,p.a,f.a,s.j,s.s,s.r],styles:[".waiting-text[_ngcontent-%COMP%]{text-align:center;font-size:1.2rem;color:#525252}.ion-name[_ngcontent-%COMP%], .ion-points[_ngcontent-%COMP%]{font-size:1.2rem;color:#686d70}.ion-icons[_ngcontent-%COMP%]{font-size:3rem}.number.sucess[_ngcontent-%COMP%]{background:#36a6da}.multiplayer-progress[_ngcontent-%COMP%]{padding:10px}.multiplayer-progress[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]:last-child{padding-top:10px}ion-content[_ngcontent-%COMP%]{--background:#e9eef4}.score-icon[_ngcontent-%COMP%]{font-size:2rem;box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12);border-radius:100%;padding:5px}.score-card[_ngcontent-%COMP%]{display:flex;align-items:center;padding:6px 0}.score-card[_ngcontent-%COMP%]   .score-rank[_ngcontent-%COMP%]{font-size:1.3rem}.score-card[_ngcontent-%COMP%]   .score-pts[_ngcontent-%COMP%]{font-size:1.2rem}.score-card[_ngcontent-%COMP%]   .score-name[_ngcontent-%COMP%]{font-size:1.1rem;padding-left:15px}.current-user[_ngcontent-%COMP%]{color:#ff9800}.score-titles[_ngcontent-%COMP%]{color:#f5f5f5;padding:15px 20px 12px;background:#4da4fc;position:-webkit-sticky;position:sticky;top:0;z-index:9}.ion-display-progress[_ngcontent-%COMP%]{display:flex;align-items:center}.ion-display-progress[_ngcontent-%COMP%]   .you[_ngcontent-%COMP%]{--background:#5bcc0c}.ion-display-progress[_ngcontent-%COMP%]   .others[_ngcontent-%COMP%]{--background:#12d9ff}.ion-display-progress[_ngcontent-%COMP%]   ion-progress-bar[_ngcontent-%COMP%]{height:30px;position:relative;left:18px;border:4px solid #fff}.ion-display-progress[_ngcontent-%COMP%]   .ion-curve[_ngcontent-%COMP%]{background:#ababab;color:#fff;border-radius:18px;width:91px;text-align:right;padding:2px 11px 2px 2px}.person-name[_ngcontent-%COMP%]{padding-left:33px;padding-top:8px;font-size:1.1rem}.timer[_ngcontent-%COMP%]{border:3px solid #fff;border-radius:30px;height:40px;color:#fff;font-size:1.2rem}.timer[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{padding-right:5px;width:6vw}.timer.more[_ngcontent-%COMP%]{background:#00b88f}.timer.danger[_ngcontent-%COMP%]{background:#e91e63}.d-flex[_ngcontent-%COMP%]{height:68%}.waiting-player[_ngcontent-%COMP%]{flex-direction:column;height:95%}.waiting-player[_ngcontent-%COMP%], .waiting-player[_ngcontent-%COMP%]   .waiting-icon[_ngcontent-%COMP%]{display:flex;align-items:center;place-content:center}.waiting-player[_ngcontent-%COMP%]   .waiting-icon[_ngcontent-%COMP%]{width:80%;height:200px;max-width:250px;border:6px solid #fff;border-radius:30px;background:#e9f6ff;background-image:url(battel2.c64d9942e922dd8054f7.png);background-repeat:no-repeat;background-position:50%;background-size:90%}.profile-img[_ngcontent-%COMP%]{width:16vw;height:16vw;margin:initial}.vs[_ngcontent-%COMP%]{font-size:1.5rem}.default-img[_ngcontent-%COMP%]{width:16vw;height:16vw;border:3px solid #f5f5f5}.default-img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{background:#00d6fc;padding:10px}"]}),Z),canDeactivate:[a.b]}],N=((q=function e(){_classCallCheck(this,e)}).\u0275mod=b.Ib({type:q}),q.\u0275inj=b.Hb({factory:function(e){return new(e||q)},imports:[[l.i.forChild(G)],l.i]}),q),U=n("PCNd"),B=((F=function e(){_classCallCheck(this,e)}).\u0275mod=b.Ib({type:F}),F.\u0275inj=b.Hb({factory:function(e){return new(e||F)},providers:[r.a,a.b],imports:[[i.c,o.d,s.I,c.c,N,o.j,U.a]]}),F)}}]);